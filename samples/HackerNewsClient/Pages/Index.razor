@page "/"
@inject HackerNewsApi Api

<PageTitle>Hacker News Demo</PageTitle>

<MudText Typo="Typo.h3" GutterBottom="true">Front Page</MudText>

<UseEndpoint Endpoint="Api.GetTopStories"
             Arg="@new(Page: 0, PageSize: 100, Tag: "front_page")"
             Context="query">
    @if (query.HasData)
    {
        <MudList>
            @foreach (var post in query.Data.Hits)
            {
                <MudListItem>
                    <PostPreview @key="post.Id" Post="post" />
                </MudListItem>
            }
        </MudList>
    }
    else if (query.IsLoading)
    {
        <MudProgressLinear Indeterminate />
    }
    else
    {
        <MudAlert Severity="Severity.Error">
            Something went wrong!
            @query.Error?.Message
            <MudButton OnClick="query.Refetch">Retry</MudButton>
        </MudAlert>
    }
</UseEndpoint>
